### **`DOC-SKIL-GDD-MAIN` (v1.3 - Final-Master)**

# **ProjectAAA: 스킬 시스템 메인 기획서 (v1.3 - 최종 마스터)**

## **1. 문서 개요**

| 항목 | 내용 |
| :--- | :--- |
| **문서 ID** | DOC-SKIL-GDD-MAIN |
| **문서명** | 스킬 시스템 메인 기획서 (Skill System Game Design Document) |
| **버전** | **1.3 (Final & Approved)** |
| **담당자** | PM/AI |
| **목적** | '조합형 커스텀 스킬' 및 '메인 룬 업그레이드' 시스템을 핵심으로, 스킬 시스템의 모든 기획적/기능적 요구사항을 최종 정의한다. 이 문서는 MGI의 모든 아키텍처 원칙을 준수한다. |
| **변경 이력**| **v1.3:** MGI 아키텍처 원칙(플러그인화, 이벤트 중계, 비동기 의무) 명시. 최종 마스터 버전. |
| | v1.2: '메인 룬' 합성/업그레이드 시스템, '코어 팩' 규칙 명확화, 시전 실패 피드백 정의. |
| | **v1.1:** '조합형 커스텀 스킬' 시스템, '실시간 스탯 미리보기', '동적 스킬 설명' 기능 추가. |
| | **v1.0:** 시스템 기본 골격, 분류, UI 연동 방안 정의. |

## **2. 시스템 개요 및 비전**

### **2.1 시스템 정의**
'스킬 시스템'은 플레이어가 전투에서 사용하는 모든 액티브, 패시브, 토글 스킬의 데이터, 로직, 생명주기를 관리하는 **독립된 기능 모듈**입니다. 이는 플레이어의 전략적 선택을 가장 역동적으로 표현하는 수단이며, STAT 및 ITEM 시스템과 유기적으로 연동됩니다.

### **2.2 설계 비전**
> **"스킬은 플레이어의 의지를 관철하는 수단이며, 전투의 흐름을 바꾸는 변수이다."**

> 스킬 시스템은 플레이어에게 단순한 공격/방어 수단을 넘어, **전투의 양상을 주도적으로 변화시키는 전략적 도구**를 제공하는 것을 목표로 한다. 아이템과 마찬가지로, 모든 스킬은 `G03` 지침서에 따라 **데이터와 로직이 완벽히 분리**되어야 한다. 이를 통해 디자이너는 코드 수정 없이 데이터 에셋 조작만으로 '단일 대상 화염구'부터 '아군 전체를 치유하는 광역 힐'까지 다채로운 스킬을 창조할 수 있다. 특히, **'스킬 파츠 조합'**을 통해 플레이어가 자신만의 스킬을 창조하는 최고의 자유도를 제공한다.

### **2.3 상위 아키텍처 원칙 (Overarching Architectural Principles)**
본 시스템은 ProjectAAA의 최상위 개발 지침(MGI)을 절대적으로 준수하며, 다음 원칙에 따라 설계 및 구현되어야 한다.

*   **아키텍처 원칙 (A1/Z2 준수):** SKIL 시스템은 독립적인 **Game Feature Plugin**으로 제공하며, 엔진 코어 및 다른 플러그인과의 C++ 레벨 강결합을 금지한다.
*   **이벤트 중계 (G00_1/G00_2 준수):** `USKIL_SkillComponent`에서 발생하는 모든 `SKIL_*` 이벤트 디스패처는 반드시 중앙 허브인 **`BP_InteractionHub`**를 통해 중계되어, 다른 시스템이 안전하게 구독할 수 있도록 해야 한다.
*   **성능 규칙 (Z1 준수):** 다수의 투사체를 동시에 발사하거나, 수십 개의 액터에게 영향을 미치는 광역 지속 피해(DoT)를 처리하는 등 단일 프레임에 심각한 부하를 유발할 수 있는 모든 로직은 **`Z1: 비동기+프레임 분산` 아키텍처를 의무적으로 적용**하여 처리해야 한다.

## **3. 스킬의 정의: 조합형 커스텀 스킬**

플레이어는 '코어 팩'이라는 설계도를 기반으로, '메인 룬'과 '옵션 파츠'라는 재료를 조합하여 자신만의 스킬을 창조한다.

### **3.1 스킬 파츠의 역할**
*   **코어 팩 (설계도):**
    *   **성장 불가.** 스킬의 기본 틀(발사체, 오라, 패시브 등)과 파츠 슬롯 개수를 결정하는 **재사용 가능한 설계도**. 더 좋은 코어 팩을 획득하는 것이 중요한 파밍 목표이다.
*   **메인 룬 (핵심 재료):**
    *   **성장 가능.** 스킬의 주 효과(화염 피해, 방어력 증가 등)를 결정하는 **소모성 재료**. 합성을 통해 등급을 올릴 수 있다.
*   **옵션 파츠 (부가 재료):**
    *   **성장 불가.** 부가 효과(다중 투사, 넉백, 흡혈 등)를 추가하는 **소모성 재료**.

### **3.2 메인 룬 업그레이드 시스템**
-   **합성:** 동일한 종류와 등급의 '메인 룬' 여러 개(개수는 데이터 테이블로 조절)를 합성하여 다음 등급의 룬 1개를 획득할 수 있다.
-   **성장의 다각화:** 룬의 등급이 오르면, 단순히 핵심 성능(`PowerValue`)만 강해지는 것이 아니라, 자원 소모율(`CostMultiplier`)과 쿨다운 제약(`CooldownModifier`)은 **오히려 감소**하여 **'스킬의 효율성'**이 함께 증가한다. 이를 통해 플레이어는 명확한 성장 체감과 만족감을 얻는다.
-   **잠재력 해방:** 특정 등급 도달 시, 숨겨진 특수 옵션이 해금되어 성장의 기대감을 더한다.

### **3.3 커스텀 스킬 제작 프로세스**
-   '스킬 제단' UI에서 **'코어 팩'**을 선택하고, **'메인 룬'**과 **'옵션 파츠'**, 그리고 **'게임 재화'**를 소모하여 완성된 스킬을 제작한다. 코어 팩은 소모되지 않는다.

## **4. 스탯 시스템 연동 심화: 실시간 미리보기**

### **4.1 기능 목표: "내 선택이 스탯에 미치는 영향을 즉시 확인한다"**
-   **시나리오 1 (스킬 제작/습득):** 플레이어가 스킬 제단이나 스킬 트리에서 특정 룬/패시브에 마우스 호버 시, **캐릭터 상태창의 관련 스탯**이 "100 -> **115**" 와 같이 **실제 변동될 최종 수치**로 즉시 변경되어 보인다.
-   **시나리오 2 (스킬 교체):** 스킬 단축키 바의 스킬을 다른 스킬과 교체하려고 할 때, 캐릭터 상태창에 두 스킬의 스탯 효과 차이값이 `+/-`로 즉시 표시된다.

### **4.2 구현 방안**
-   아이템 비교와 **동일한 메커니즘**을 사용한다. `DOC-STAT-GDD-MAIN (v1.4)`에서 정의한 `I_STAT_Comparable_If::GetStatDeltaComparedTo()` 기능을 그대로 활용한다.
-   특히 "방어력의 20%만큼 공격력 상승"과 같은 복합 옵션은, `USKIL_SkillViewModel`이 **현재 캐릭터의 방어력 값을 실시간으로 참조**하여 "공격력 +15" 와 같은 구체적인 `Modifier`로 즉시 변환한 후 `STAT` 시스템에 가상 계산을 요청한다.

## **5. UI 연동 및 표시 명세**

### **5.1 UI 연동 아키텍처: MVVM**
*   **Model:** `USKIL_SkillComponent`
*   **ViewModel:** `USKIL_SkillViewModel` (스킬 제작, 스킬 바, 툴팁 데이터 총괄)
*   **View:** `WBP_SkillAltar`, `WBP_SkillBar`, `WBP_SkillTooltip`

### **5.2 동적 스킬 설명 (Dynamic Tooltip)**
-   **원칙:** 스킬 툴팁의 설명은 고정된 텍스트가 아닌, **현재 캐릭터의 스탯과 장비에 따라 실시간으로 변하는 값**을 포함해야 한다.
-   **구현:** 툴팁 텍스트는 "적에게 {Damage}의 화염 피해를 입힙니다." 와 같은 **포맷팅된 문자열**로 저장한다. UI는 `{Damage}` 키워드를 현재 스탯으로 계산된 실제 피해량으로 실시간 치환하여 보여준다.

### **5.3 스킬 시전 피드백**
플레이어의 행동에 대한 명확하고 즉각적인 시각적 피드백을 제공한다.

-   **마나 부족:** 스킬 사용 시 마나가 부족할 경우, 해당 스킬의 단축키 아이콘이 **붉은색으로 짧게 점멸**한다.
-   **쿨다운:** 스킬 사용 후 재사용 대기시간 중일 경우, 단축키 아이콘 위에 **남은 시간이 숫자로 표시**되며 점차 투명해지는 오버레이 효과가 적용된다.
-   **시전 불가:** 기타 조건(침묵 상태 등)으로 스킬 사용이 불가능할 경우, 단축키 아이콘이 **회색으로 비활성화** 처리된다.
-   **참고:** 피로도 및 다른 피드백과의 중복을 피하기 위해, 시전 실패 시 별도의 **사운드는 재생하지 않는다.**

### **5.4 핵심 UI 요소**
-   **스킬 제단 (Skill Altar):** 플레이어가 `코어 팩`, `메인 룬`, `옵션 파츠`를 조합하는 전용 UI. 드래그 앤 드롭을 지원하며, 파츠를 장착할 때마다 최종 스킬의 예상 성능(마나소모, 쿨다운, 피해량)이 실시간으로 업데이트되어 보인다.
-   **스킬 단축키 바 (Skill Bar):** 등록된 스킬 아이콘, 재사용 대기시간 오버레이, 마나 부족 표시 등을 지원한다.
-   **스킬 툴팁 (Skill Tooltip):** `DA_Skill` 및 조합된 파츠들의 모든 정보를 담은 상세 정보를 동적으로 표시한다.

## **6. 스킬 습득 및 관리**

-   **스킬 파츠 획득:** 커스텀 스킬 제작에 필요한 모든 파츠(`코어 팩`, `메인 룬`, `옵션 파츠`)는 몬스터 드랍, 필드 채집, 퀘스트 보상, 제작 등 다양한 경로를 통해 획득할 수 있다.
-   **아이템/세트 효과 연동:** 특정 아이템을 장착하거나 아이템 세트 효과가 발동하면, `SKIL` 시스템이 `STAT` 시스템으로부터 부여된 관련 태그(`Ability.CanActivate.*`)를 감지하여, 플레이어가 제작하지 않은 특별한 스킬을 임시로 활성화하거나 자동 시전할 수 있다.

---
